# 金融领域强一致性判断指南

## 一、强一致性必须满足的条件
| 判断维度       | 具体标准                                                                 | 金融示例                     |
|----------------|--------------------------------------------------------------------------|----------------------------|
| 资金安全性要求 | 操作必须100%原子性完成，不允许中间状态                                  | 跨行转账的借贷平衡          |
| 实时性约束     | 所有节点/系统必须在操作完成后立即看到最新数据                           | 账户余额更新                |
| 监管合规要求   | 金融监管机构明确规定必须保证强一致性                                   | 交易结算系统                |
| 数据关联性     | 操作涉及多个关联资源                                                   | 复合金融产品交易            |

## 二、可接受最终一致性的场景
| 判断维度       | 具体标准                                                                 | 金融示例                     |
|----------------|--------------------------------------------------------------------------|----------------------------|
| 非核心业务     | 允许短暂数据不一致（<1秒）                                             | 用户登录次数统计            |
| 数据可修复性   | 支持事后对账补偿                                                       | 支付手续费计算              |
| 高并发写入     | 写入QPS>10,000且延迟敏感                                               | 证券行情快照缓存            |
| 跨系统协同     | 涉及外部系统无法保证原子性                                            | 跨境汇款中间状态            |

## 三、判断流程图
```mermaid
graph TD
    A[开始] --> B{是否涉及资金变动?}
    B -->|是| C[必须强一致性]
    B -->|否| D{是否影响交易决策?}
    D -->|是| E{数据延迟容忍度}
    D -->|否| F[允许最终一致性]
    E -->|≤100ms| C
    E -->|>100ms| F
